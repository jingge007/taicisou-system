(self["webpackChunktaicisou_system"]=self["webpackChunktaicisou_system"]||[]).push([[896],{9896:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return h}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"analysis_list_box"},[e("Upload",{staticClass:"upload_box",attrs:{multiple:"",action:"*",type:"drag","before-upload":t.handleBeforeUpload}},[e("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),e("p",{staticClass:"text"},[t._v("单击或拖动字幕文件上传")]),e("span",{staticClass:"note_txt"},[t._v("*注：当前仅支持上传后缀为srt的字幕文件~~")])],1),e("Button",{staticClass:"options_btn",attrs:{type:"primary",size:"large"},on:{click:t.importBtn}},[t._v("导出")])],1)},a=[],i=(n(7658),n(6229),n(7330),n(2062),n(4161));const s="300.424",l=t=>new Promise(((e,n)=>{(0,i.Z)({loading:!0,method:"get",url:"/ajax/search",params:t}).then((t=>{e(t)})).catch((t=>{n(t)}))}));var r=n(6154),c=n.n(r),u={data(){return{filesData:[],subtitleData:[]}},created(){},methods:{importBtn(){let t={aaa:"账号：323232",title:"收到货收到货的发但是公司电话的发挥地方"};const e=new Blob([JSON.stringify(t)],{type:"text/plain;charset=utf-8"});c().saveAs(e,"erorr.txt"),window.location.reload()},handleBeforeUpload(t){return this.filesData.push(t),!1},GetSrtInfo(t,e,n,o){let a=this,l=n.list[0],r=l.img.split("w.h"),c={title:e.name.split(".srt")[0],cover_url:`${r[0]+s+r[1]}`,subtitle:[],movies:l};i.Z.get(t,{isbaseUrl:!0}).then((function(t){let e=t;e.length>0&&e.map((t=>{let e=t.split(/\n/);if(e.length>=4){if(e[2].indexOf("}")>-1){let t=e[2].split("}");t.length>2?e[2]=t[t.length-1]:e[2]=t[1]}if(e[3].indexOf("}")>-1){let t=e[3].split("}");t.length>2?e[3]=t[t.length-1]:e[3]=t[1]}let t=new RegExp("[A-Za-z]+"),n=new RegExp("[\\u4E00-\\u9FFF]+","g");if(t.test(e[2])){let t=e[2];e[2]=e[3],e[3]=t}!n.test(e[3])&&t.test(e[3])&&c.subtitle.push({sort:e[0],ch_text:e[2],es_test:e[3],text:(e[2]+e[3]).replace(/[a-zA-Z]/,"\n"),start_time:e[1].split(" --\x3e ")[0].split(",")[0],end_time:e[1].split(" --\x3e ")[1].split(",")[0]})}})),a.subtitleData.push(c),a.exportJSON(c,l.nm),console.log("解析之后的字幕内容",a.subtitleData)})).catch((function(t){console.log("-----请求失败-----",t)}))},handerData(t){let e=this;t.length>0&&t.map((n=>{let o=URL.createObjectURL(n),a=n.name.split(".srt")[0],i={kw:a,cityId:30,stype:-1};l(i).then((a=>{e.GetSrtInfo(o,n,a.movies,t)}))}))},exportJSON(t,e){const n=new Blob([JSON.stringify(t)],{type:""});c().saveAs(n,`${e}.json`),window.location.reload()}},watch:{filesData:{handler(t){this.handerData(t)},deep:!0}}},p=u,f=n(1001),d=(0,f.Z)(p,o,a,!1,null,"5210b704",null),h=d.exports},6154:function(t,e,n){var o,a,i;(function(n,s){a=[],o=s,i="function"===typeof o?o.apply(e,a):o,void 0===i||(t.exports=i)})(0,(function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function o(t,e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){r(o.response,e,n)},o.onerror=function(){console.error("could not download file")},o.send()}function a(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(o){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,l=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(t,e,n){var l=s.URL||s.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener","string"==typeof t?(r.href=t,r.origin===location.origin?i(r):a(r.href)?o(t,e,n):i(r,r.target="_blank")):(r.href=l.createObjectURL(t),setTimeout((function(){l.revokeObjectURL(r.href)}),4e4),setTimeout((function(){i(r)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,s){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,s),n);else if(a(t))o(t,n,s);else{var l=document.createElement("a");l.href=t,l.target="_blank",setTimeout((function(){i(l)}))}}:function(t,e,n,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof t)return o(t,e,n);var i="application/octet-stream"===t.type,r=/constructor/i.test(s.HTMLElement)||s.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||i&&r||l)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=t:location=t,a=null},u.readAsDataURL(t)}else{var p=s.URL||s.webkitURL,f=p.createObjectURL(t);a?a.location=f:location.href=f,a=null,setTimeout((function(){p.revokeObjectURL(f)}),4e4)}});s.saveAs=r.saveAs=r,t.exports=r}))}}]);
//# sourceMappingURL=896.0152a0f3.js.map